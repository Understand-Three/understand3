---
title: 零知识证明
author: simons
tags:
  - tech
---

# 零知识证明

## 一、引言

在不透露任何有意义的信息的情况下，我如何才能知道你是真的认识 `8` 这个数字

```bash
t 0 0 p 0 q 0 0 0 0
0 8 0 6 o 0 g $ 1 s
u r 0 0 n 2 0 z 0 f
0 @ 9 i 0 0 h 0 & 0
0 e 0 0 j 0 c 0 4 0
0 0 v 7 b y 3 0 k m
w 0 x d 0 0 a 0 5 l
```



假设：

> 图片中的 `8` 在哪里?
>
> 1. 在第二行第二列
>
>    ❌：第二行第二列是有意义的信息
>
> 2. 写出 `8`
>
>    ❌：`8` 是有意义的信息
>
> 3. 任意猜一个，猜到了 `8`
>
>    ❌：打乱顺序，并证明者让进行多轮选择



零知识证明必须满足三个性质：

- 完备性：如果陈述为真，诚实的验证者将被诚实的证明者说服。
- 严密性：如果陈述为假，没有不诚实的证明者能够说服诚实的验证者。证明系统是诚实的，不允许作弊。
- 零知识性：如果陈述为真，没有验证者会获得除了这个陈述为真之外的任何信息。



## 二、灰姑娘问题

**交互式零知识证明**



### 故事背景

> 灰姑娘是一个受虐待的年轻女子，她的继母和继姐对她很刻薄。一次，王子举办舞会选新娘，灰姑娘在小鸟的帮助下穿上华服和水晶鞋出席。她与王子共舞，但午夜必须离开，匆忙中掉了一只水晶鞋。王子用这只遗落的水晶鞋作为线索，走遍了王国中的每一个角落，让每一个适龄的女子试穿。经过一番漫长的寻找，最终在灰姑娘简陋的家中找到了那只刚好能穿着双鞋的人 —— 灰姑娘。王子认出了灰姑娘就是舞会上那位美丽的女子，没有丝毫犹豫，便向她求婚。灰姑娘欣然接受，两人举行了盛大的婚礼。过上了幸福生活。



### 故事修改

每个女子都不能穿这双鞋，而是告诉王子写在不在鞋堆里面，并且不能透露任何关于鞋的任何信息，以免被其他人知道。



### 使用 `交互式零知识证明` 帮助王子辨别谁是灰姑娘：

#### 前提

- 除了灰姑娘外的每一个适龄女子都不知道鞋子的大小和外观，所以其他人只能猜，并且每个人在每一次选鞋中只有一次机会。

- 适龄女子不能穿鞋，只能看，然后指出自己的鞋子。

- 灰姑娘知道自己鞋子上的不容易被察觉的特殊标记，比如有一个特别的细微划痕。

- 王子也在这双鞋上做了标记，但是同样不起眼。



#### 构建

- 王子叫仆人买了很多大小和外观相同的鞋子，只有王子和灰姑娘记得的标记除外。

- 这些鞋子被分为很多个堆，那双唯一的水晶鞋就在其中一堆。



#### 执行

1. **承诺（Commitment）**：
   - 每一个适龄女子（证明者）都向王子（验证者）承诺自己知道那双唯一的水晶鞋在哪个鞋堆。
2. **挑战（Challenge）**：
   - 王子（验证者）会提出一个挑战，要求适龄女子（证明者）指出那个有灰姑娘水晶鞋的唯一鞋堆。
3. **响应（Response）**：
   - 适龄女子（证明者）会在王子（验证者）的监督下，去指出那个有灰姑娘的水晶鞋的鞋堆。
4. **验证（Verification）**：
   - 王子（验证者）会验证适龄女子（证明者）指出的鞋堆，如果鞋堆里面的鞋子上面有王子的标记 —— 灰姑娘的水晶鞋，那么王子就会知道该女子确实知道灰姑娘的水晶鞋，而无需知道她是如何知道的。
5. **完成（Completion）**：
   - 如果王子（验证者）对适龄女子（证明者）的答案感到满意，他会确认她就是舞会上的灰姑娘。这个过程可以重复几次，以确保证明的可靠性 —— 不是适龄女子猜出来的答案。





## 三、小红帽问题

**非交互式零知识证明**



### 背景

> 从前，有一个小女孩，大家都喜欢叫她小红帽，因为她总是戴着一顶红色的帽子。有一天，小红帽的母亲让她给生病的奶奶送一些食物和药品。妈妈叮嘱说，“到奶奶家的时候，别忘了说'早上好'，也不要一进屋就东瞧西瞅。”
>
> 在去奶奶家的路上，小红帽遇到了一只狡猾的狼。狼询问小红帽的目的地，天真的小红帽告诉了狼她要去奶奶家。狼于是建议小红帽去采一些花给奶奶，以拖延她的时间。
>
> 狼趁机跑到奶奶家，把奶奶吞进了肚子，然后假扮成奶奶躺在床上等待小红帽。小红帽采完花后来到奶奶家，发现“奶奶”的样子有些奇怪，但没多想。
>
> 最终，狼露出了真面目，企图吃掉小红帽。幸运的是，一个伐木工人听到了动静，及时赶到，救了小红帽和她的奶奶。伐木工人用剪刀剪开狼的肚子，救出了奶奶，并用石头填满狼的肚子，让它再也不能伤害人。



### 故事修改

狼已经吃了奶奶，躺在床上，但是小红帽在完全不知情的情况下，如何知道奶奶是不是狼假扮的。



### 使用 `非交互式零知识证明` 帮助小红帽辨别奶奶是不是“狼”：



#### 前提

- 灰姑娘知道房间里的东西

- 奶奶可以行动

- 奶奶和小红帽对房间内物品的物品认知是一样的

- 狼不知道房间里的物品布局



### 零知识证明的过程：

1. **验证者（小红帽）和证明者（奶奶）的初始对话**：
   - 小红帽（验证者）和奶奶（证明者）问好。
2. **挑战（Challenge）**：
   - 小红帽（验证者）叫奶奶（证明者）拿出一支红色的钢笔。
3. **响应（Response）**：
   - 奶奶（证明者）拿出一支红色的钢笔
4. **验证（Verification）**：
   - 小红帽（验证者）检查这支笔确实是红色的钢笔。
5. **完成（Completion）**：
   - 如果奶奶（证明者）每次的回答都是正确的，那么就可以确定奶奶不是狼假扮的。为了确保安全性，小红帽可以叫奶奶拿出不同的东西

